{% extends "atendimento/base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
<h2 class="mb-4">Dashboard</h2>

<form method="get" class="row g-3 mb-4">
    <div class="col-md-3">
        <label for="mes_inicio" class="form-label">Mês início</label>
        <input type="month" class="form-control" name="mes_inicio" id="mes_inicio" value="{{ mes_inicio }}">
    </div>
    <div class="col-md-3">
        <label for="mes_fim" class="form-label">Mês fim</label>
        <input type="month" class="form-control" name="mes_fim" id="mes_fim" value="{{ mes_fim }}">
    </div>
    <div class="col-md-3">
        <label for="status" class="form-label">Status</label>
        <select name="status" id="status" class="form-select">
            <option value="todos" {% if status_filtro == "todos" %}selected{% endif %}>Todos</option>
            <option value="aberto" {% if status_filtro == "aberto" %}selected{% endif %}>Aberto</option>
            <option value="andamento" {% if status_filtro == "andamento" %}selected{% endif %}>Em andamento</option>
            <option value="resolvido" {% if status_filtro == "resolvido" %}selected{% endif %}>Resolvido</option>
        </select>
    </div>
    <div class="col-md-3 align-self-end">
        <button type="submit" class="btn btn-primary w-100">Filtrar</button>
    </div>
</form>

{% if msg %}
<p>{{ msg }}</p>
{% else %}

<div class="row">
    <div class="col-lg-6 col-md-12 mb-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title text-center">Chamados abertos por mês</h5>
                <img src="data:image/png;base64,{{ images.abertos_mes }}" class="img-fluid mx-auto d-block">
            </div>
        </div>
    </div>

    <div class="col-lg-6 col-md-12 mb-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title text-center">Chamados por categoria</h5>
                <img src="data:image/png;base64,{{ images.por_categoria }}" class="img-fluid mx-auto d-block">
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-lg-6 col-md-12 mb-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title text-center">Chamados por status</h5>
                <img src="data:image/png;base64,{{ images.abertos_fechados }}" class="img-fluid mx-auto d-block">
            </div>
        </div>
    </div>

    <div class="col-lg-6 col-md-12 mb-4">
        <div class="card shadow-sm">
            <div class="card-body">
                <h5 class="card-title text-center">Tempo médio de atendimento (h)</h5>
                <img src="data:image/png;base64,{{ images.tempo_medio }}" class="img-fluid mx-auto d-block">
            </div>
        </div>
    </div>
</div>

{% endif %}
{% endblock %}
